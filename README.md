# PredictMusicGenre
Predicting Music Genres

The goal of this project is to try to build an effective model that can determine the genre of a song based on the characteristics of the song. There are 10 genres to look at:  Electronic, Anime, Jazz, Alternative, Country, Rap, Blues, Rock, Classical, and Hip-Hop. The characteristics for every song are popularity, acousticness, danceability, duration_ms, energy, instrumentalness, liveness, loudness, speechiness, tempo, valence, and music_genre.

First, I cleaned the dataset. I removed the attributes 'instance_id', 'artist_name', 'track_name', 'key', 'mode', and 'obtained_date'  since they are irrelevant to forming a model about genre. I then removed rows where the ‘duration_ms’ = -1 and the ‘tempo’ = ‘?’. After this, I dropped 5 random rows with null values. 
Then I went through EDA. I analyzed the skew and kurtosis of all variables using a histogram. I then checked the variables with many outliers using a boxplot. Here I found correlated variables, but I moved it down the workflow since it made more sense when I was simplifying the problem. 

The first model I used was decision trees, and the model scored an accuracy of roughly 0.4331, which is not great. The model was also overfitting, but this is common in decision trees. To reduce this, I reduced the maximum depth of the tree, but at most this only made a difference of 0.003 in the test set accuracy. 
I then switched to using random forests, since it’s good for many features and a lot of data. Initially, I set the number of estimators to 100 and found that the accuracy was around 0.5474. I set the number of estimators to 250 and found that the accuracy was around 0.5531. I then set the number of estimators to 500 and the accuracy was 0.5515. Because of the runtime, I determined it was best to reduce the number of trees to 300.
I then set a gradient boosted model since every tree fixes previous mistakes. It lowered the accuracy of the training set to around 0.646, but it increased the accuracy of the test set to around 0.5797.

After this, I decided to construct a model that only considered features that had strong correlation with the genre. I used the ordinal encoder to convert the music_genre to a numeric value and built a heatmap. I found that 6 attributes had a strong correlation: danceability, popularity, loudness, speechiness, instrumentalness, and acousticness. I reconstructed another Decision Tree model with only these features and found that the accuracy of the test set fell to around 0.3827.

As a result, I decided to simplify the problem; I had to do more data analysis. What a genre means is mostly arbitrary. For example, some hip-hop songs are similar in style and sound to rap songs, with minor differences. By plotting the boxplot you can see for every attribute that the values for hip-hop and rap reflect that. This convolutes the model, so I wanted to get rid of that. Another case is anime music. It’s unclear what “anime music” even is. Most anime music consists of japanese pop/hip-hop songs, but it’s not a set genre. One observation I made was that although anime music is essentially pop/hip-hop, some of the most popular and danceable genres, in japanese; it scored some of the lowest in these categories in the dataset. Cultural reasons can explain this, but this means at best the model will never be an objective determination of genres based on its musical characteristics.

I dropped Hip-Hop as a genre, and re-constructed models with this while keeping the same parameters. With the new decision tree model, I found that the accuracy of the test set increased from  0.4331 to around 0.4493. With the new random forest model, the test accuracy increased from 0.5474 to around 0.5532. Lastly, I constructed a gradient boosted model and found that the accuracy of the test set increased from 0.5797 to around 0.6079.
After simplifying the problem by deleting the most similar genre to another, the largest difference in accuracy was the gradient boosted model, which only increased by less than 3 percent. Thus, in order to increase the accuracy of the model significantly, we would need to delete many similar genres, which would over-simplify the problem.

